from django import forms
from django.forms import ModelForm

from .utils import ScanTitleWidget, ScanTypeOptionsWidget
from .models import Scan


class ScanConfigForm(ModelForm):
    class Meta:
        model = Scan
        fields = [
            'scan_title',
            'scan_type',
            'targets',
            'ports',
            'udp',
        ]
        labels = {
            'scan_title': 'Scan Title',
            'scan_type': 'Scan Type',
            'targets': 'Targets',
            'ports': 'Ports',
            'udp': 'UDP Scan',
        }
        widgets = {
            'scan_title': ScanTitleWidget(attrs={
                'placeholder': 'Scan Title',
            }),
            'scan_type': ScanTypeOptionsWidget(attrs={
                'class': 'form-control',
            }),
            'targets': forms.TextInput(attrs={
                'placeholder': '<target1>[,<target2>,...], target can be IP (e.g., 127.0.0.1), domain (e.g., gnu.org), or network (e.g., 0.0.0.0/24)',
                'class': 'form-control',
            }),
            'ports': forms.TextInput(attrs={
                'placeholder': '<port1>[,<port2>,...], port can be single port (e.g., 80), or range (e.g., 1-1000)',
                'class': 'form-control',
            }),
            'udp': forms.CheckboxInput(attrs={
                'class': 'form-check-input',
            }),
        }
